{% comment%}
---
regenerate:                         false
---
Note:   Remove comment for production
{% endcomment%}

{% comment%}

    The liquid template search.json is used by SimpleJekyllSearch, a JavaScript
    library to add search functionality to any Jekyll Site or Blog. the template
    is a helper to generate the corresponding search index data file search.json
    within the site generated by Jekyll.

    The Liquid generates a JSON file as an array that contains objects for all
    posts and pages included for indexing. See below the fields taken from the
    source files.

  NOTE:
    Be carefull change the Liquid code. If the code is changed, check the
    interity of the JSON data created. Corrupted JSON data will make the
    Javascript portion of SimpleJekyllSearch to fail and search functionality
    willl be available.

{% endcomment%}

{% capture jbx_cache %}

  {% for post in site.posts %}
  {% unless post.noindex %}
  {
    "title"    : "{{ post.title | escape }}",
    "category" : "{{ post.category }}",
    "tagline"  : "{{ post.tagline }}",
    "tags"     : "{{ post.tags | join: ', ' }}",
    "index"    : "{{ site.source_root | append: '/' | append: post.path | regex_replace: '\\', '/' }}",
    "url"      : "{{ site.baseurl }}{{ post.url }}.html",
    "date"     : "{{ post.date }}"
  }, {% endunless %}
  {% endfor %}

  {% for page in site.pages %}
  {% unless page.noindex %}
  {% unless page.url contains 'assets' or page.url contains '.json' or page.url contains '.txt' %}
  {
    "title"    : "{{ page.title | escape }}",
    "group" : "{{ page.group }}",
    "tagline"  : "{{ page.tagline }}",
    "tags"     : "{{ page.tags | join: ', ' }}",
    "index"    : "{{ site.source_root | append: '/' | append: page.path | regex_replace: '\\', '/' }}",
    "url"      : "{{ site.baseurl }}{{ page.url }}"
  }, {% endunless %} {% endunless %}
  {% endfor %}

  {}

{% endcapture %}

[
  {{ jbx_cache | strip_empty_lines }}
]

{% assign jbx_cache = nil %}